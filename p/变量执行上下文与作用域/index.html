<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='变量 JavaScript 中的变量是松散的，它可以在初始化后再次改变类型。\nJavaScript 中的变量声明使用的关键字（var、let、const）也与常见编程语言不同，其作用不是指定其类型，而是限定其作用域。\nJavaScript 变量的类型由其值决定，变量值类型改变，变量类型随之改变。\n原始值和引用值 JavaScript 变量值分为原始值和引用值。\n原始值（primitive value）是最简单的数据，大小固定，保存在栈内存，有 6 中原始值类型：\nUndefined Null Boolean Number String Symbol 引用值是由多个值（既可以是原始值，也可以是引用值）组合成的对象，动态大小，引用值的地址值保存在栈内存，其指向的是该地址对应的保存在堆内存上的真实数据。\n字面量 字面量就是字面上的纯数据。\n原始值以及引用值的初始化既可以使用纯数据，也可以使用 new 执行对应类型的构造函数，通过后者得到的原始值就与对象的表现类似：\n1 2 3 4 5 6 let name = new String("张三"); // 可以添加属性 person.age = 23; console.log(person.age); // 23 // typeof 返回 Object console.log(typeof name); // object 属性 原始值没有属性，也不能添加属性，引用值可以动态地添加、修改和删除属性。\n复制值 JavaScript中，原始值的复制就是复制其在栈内存上的值，引用值的复制实际上复制的是其位于栈内存的引用地址值。\n传递参数 ECMAScript 中所有参数都是按值传递的。这意味着中间存在变量的复制。\n形参与实参 形参是函数局部变量，实参是函数外部变量以及形参的来源。\n按值传递和按引用传递 从变量到数据，涉及到存储寻址，一个变量名对应一个地址，访问该地址获取到改地址的值，值可以为原始值或者另一个地址，地址值指示真正数据的位置。\n● 地址 1 -数据\n● 地址 1 -地址 2 -数据\n'><title>变量、执行上下文与作用域</title>
<link rel=canonical href=https://demo.stack.jimmycai.com/p/%E5%8F%98%E9%87%8F%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F/><link rel=stylesheet href=/scss/style.min.7347e7ea1528544a7b0df44feb6bbe2eebb22da4da5a0ca89cda2beac1b6fe4b.css><meta property='og:title' content="变量、执行上下文与作用域"><meta property='og:description' content='变量 JavaScript 中的变量是松散的，它可以在初始化后再次改变类型。\nJavaScript 中的变量声明使用的关键字（var、let、const）也与常见编程语言不同，其作用不是指定其类型，而是限定其作用域。\nJavaScript 变量的类型由其值决定，变量值类型改变，变量类型随之改变。\n原始值和引用值 JavaScript 变量值分为原始值和引用值。\n原始值（primitive value）是最简单的数据，大小固定，保存在栈内存，有 6 中原始值类型：\nUndefined Null Boolean Number String Symbol 引用值是由多个值（既可以是原始值，也可以是引用值）组合成的对象，动态大小，引用值的地址值保存在栈内存，其指向的是该地址对应的保存在堆内存上的真实数据。\n字面量 字面量就是字面上的纯数据。\n原始值以及引用值的初始化既可以使用纯数据，也可以使用 new 执行对应类型的构造函数，通过后者得到的原始值就与对象的表现类似：\n1 2 3 4 5 6 let name = new String("张三"); // 可以添加属性 person.age = 23; console.log(person.age); // 23 // typeof 返回 Object console.log(typeof name); // object 属性 原始值没有属性，也不能添加属性，引用值可以动态地添加、修改和删除属性。\n复制值 JavaScript中，原始值的复制就是复制其在栈内存上的值，引用值的复制实际上复制的是其位于栈内存的引用地址值。\n传递参数 ECMAScript 中所有参数都是按值传递的。这意味着中间存在变量的复制。\n形参与实参 形参是函数局部变量，实参是函数外部变量以及形参的来源。\n按值传递和按引用传递 从变量到数据，涉及到存储寻址，一个变量名对应一个地址，访问该地址获取到改地址的值，值可以为原始值或者另一个地址，地址值指示真正数据的位置。\n● 地址 1 -数据\n● 地址 1 -地址 2 -数据\n'><meta property='og:url' content='https://demo.stack.jimmycai.com/p/%E5%8F%98%E9%87%8F%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F/'><meta property='og:site_name' content='DawnKylin'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='JavaScript'><meta property='article:published_time' content='2025-01-06T12:34:00+08:00'><meta property='article:modified_time' content='2025-01-06T12:34:00+08:00'><meta name=twitter:title content="变量、执行上下文与作用域"><meta name=twitter:description content='变量 JavaScript 中的变量是松散的，它可以在初始化后再次改变类型。\nJavaScript 中的变量声明使用的关键字（var、let、const）也与常见编程语言不同，其作用不是指定其类型，而是限定其作用域。\nJavaScript 变量的类型由其值决定，变量值类型改变，变量类型随之改变。\n原始值和引用值 JavaScript 变量值分为原始值和引用值。\n原始值（primitive value）是最简单的数据，大小固定，保存在栈内存，有 6 中原始值类型：\nUndefined Null Boolean Number String Symbol 引用值是由多个值（既可以是原始值，也可以是引用值）组合成的对象，动态大小，引用值的地址值保存在栈内存，其指向的是该地址对应的保存在堆内存上的真实数据。\n字面量 字面量就是字面上的纯数据。\n原始值以及引用值的初始化既可以使用纯数据，也可以使用 new 执行对应类型的构造函数，通过后者得到的原始值就与对象的表现类似：\n1 2 3 4 5 6 let name = new String("张三"); // 可以添加属性 person.age = 23; console.log(person.age); // 23 // typeof 返回 Object console.log(typeof name); // object 属性 原始值没有属性，也不能添加属性，引用值可以动态地添加、修改和删除属性。\n复制值 JavaScript中，原始值的复制就是复制其在栈内存上的值，引用值的复制实际上复制的是其位于栈内存的引用地址值。\n传递参数 ECMAScript 中所有参数都是按值传递的。这意味着中间存在变量的复制。\n形参与实参 形参是函数局部变量，实参是函数外部变量以及形参的来源。\n按值传递和按引用传递 从变量到数据，涉及到存储寻址，一个变量名对应一个地址，访问该地址获取到改地址的值，值可以为原始值或者另一个地址，地址值指示真正数据的位置。\n● 地址 1 -数据\n● 地址 1 -地址 2 -数据\n'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu3473101363185682893.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>DawnKylin</a></h1><h2 class=site-description>南风知我意，吹梦到西洲。</h2></div></header><ol class=menu-social><li><a href=https://github.com/dawnkylin target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#变量>变量</a><ol><li><a href=#原始值和引用值>原始值和引用值</a></li><li><a href=#字面量>字面量</a></li><li><a href=#属性>属性</a></li><li><a href=#复制值>复制值</a></li><li><a href=#传递参数>传递参数</a><ol><li><a href=#形参与实参>形参与实参</a></li><li><a href=#按值传递和按引用传递>按值传递和按引用传递</a></li></ol></li><li><a href=#变量类型判断>变量类型判断</a></li><li><a href=#变量声明>变量声明</a><ol><li><a href=#var-声明>var 声明</a></li><li><a href=#let-声明>let 声明</a></li><li><a href=#const-声明>const 声明</a></li></ol></li></ol></li><li><a href=#执行上下文与作用域>执行上下文与作用域</a><ol><li><a href=#执行上下文>执行上下文</a></li><li><a href=#作用域-scope>作用域 Scope</a></li><li><a href=#函数的-scopes-属性>函数的 [[Scopes]] 属性</a><ol><li><a href=#查看-scopes-属性>查看 [[Scopes]] 属性</a></li></ol></li><li><a href=#执行上下文与作用域的关系>执行上下文与作用域的关系</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/frontend/ style=background-color:#2a9d8f;color:#fff>前端</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E5%8F%98%E9%87%8F%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F/>变量、执行上下文与作用域</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jan 06, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><h1 id=变量>变量</h1><p>JavaScript 中的变量是松散的，它可以在初始化后再次改变类型。</p><p>JavaScript 中的变量声明使用的关键字（var、let、const）也与常见编程语言不同，其作用不是指定其类型，而是限定其作用域。</p><p>JavaScript 变量的类型由其值决定，变量值类型改变，变量类型随之改变。</p><h2 id=原始值和引用值>原始值和引用值</h2><p>JavaScript 变量值分为原始值和引用值。</p><p>原始值（primitive value）是最简单的数据，大小固定，保存在栈内存，有 6 中原始值类型：</p><ul><li>Undefined</li><li>Null</li><li>Boolean</li><li>Number</li><li>String</li><li>Symbol</li></ul><p>引用值是由多个值（既可以是原始值，也可以是引用值）组合成的<strong>对象</strong>，动态大小，引用值的地址值保存在栈内存，其指向的是该地址对应的保存在堆内存上的真实数据。</p><h2 id=字面量>字面量</h2><p>字面量就是字面上的纯数据。</p><p>原始值以及引用值的初始化既可以使用纯数据，也可以使用 <code>new</code> 执行对应类型的构造函数，通过后者得到的原始值就与对象的表现类似：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>let</span> <span class=nx>name</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>String</span><span class=p>(</span><span class=s2>&#34;张三&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// 可以添加属性
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>person</span><span class=p>.</span><span class=nx>age</span> <span class=o>=</span> <span class=mi>23</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>person</span><span class=p>.</span><span class=nx>age</span><span class=p>);</span> <span class=c1>// 23
</span></span></span><span class=line><span class=cl><span class=c1>// typeof 返回 Object
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=k>typeof</span> <span class=nx>name</span><span class=p>);</span> <span class=c1>// object
</span></span></span></code></pre></td></tr></table></div></div><h2 id=属性>属性</h2><p>原始值没有属性，也不能添加属性，引用值可以动态地添加、修改和删除属性。</p><h2 id=复制值>复制值</h2><p>JavaScript中，原始值的复制就是复制其在栈内存上的值，引用值的复制实际上复制的是其位于栈内存的引用地址值。</p><p><img src=/p/%E5%8F%98%E9%87%8F%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F/%E5%A4%8D%E5%88%B6%E5%80%BC.png width=646 height=464 srcset="/p/%E5%8F%98%E9%87%8F%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F/%E5%A4%8D%E5%88%B6%E5%80%BC_hu5040404717299386775.png 480w, /p/%E5%8F%98%E9%87%8F%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F/%E5%A4%8D%E5%88%B6%E5%80%BC_hu17320051903633799013.png 1024w" loading=lazy alt=复制值 class=gallery-image data-flex-grow=139 data-flex-basis=334px></p><h2 id=传递参数>传递参数</h2><p>ECMAScript 中所有参数都是按值传递的。这意味着中间存在变量的复制。</p><h3 id=形参与实参>形参与实参</h3><p>形参是函数局部变量，实参是函数外部变量以及形参的来源。</p><h3 id=按值传递和按引用传递>按值传递和按引用传递</h3><p>从变量到数据，涉及到存储寻址，一个变量名对应一个地址，访问该地址获取到改地址的值，值可以为原始值或者另一个地址，地址值指示真正数据的位置。</p><p>● 地址 1 -数据</p><p>● 地址 1 -地址 2 -数据</p><p>按值传递：形参、实参的地址 1 不同，但是地址 1 对应的数据或者地址 2 是相同的，这个也是按值所传递的东西。</p><p>按引用传递：形参、实参地址 1 相同，所以后面寻址操作是一样的。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>setName</span><span class=p>(</span><span class=nx>obj</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>obj</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=s2>&#34;Nicholas&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>obj</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Object</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=nx>obj</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=s2>&#34;Greg&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>person</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Object</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>setName</span><span class=p>(</span><span class=nx>person</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>person</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span> <span class=c1>// &#34;Nicholas&#34;
</span></span></span></code></pre></td></tr></table></div></div><p>上述代码中，函数 setName 第二行重写了 obj，再修改 obj 无效，正是因为按值传递，重写 obj 是修改 obj 地址对应的数据，obj 这个形参与实参 person 的地址不同，重写 obj 不会导致 person 重写。</p><h2 id=变量类型判断>变量类型判断</h2><p>常见的类型判断方法是使用 <code>typeof</code> 和 <code>instanceof</code>。</p><p>typeof 适合判断一个变量是否是原始值。如果值是对象或 null，typeof 都会返回 null。使用 typeof 检测函数返回 function。</p><p>对于对象，使用 instanceof 操作符。对于该对象原型链上的所有原型，instanceof 都返回 true。若对原始值使用 instanceof，则返回 false。</p><h2 id=变量声明>变量声明</h2><h3 id=var-声明>var 声明</h3><p>在使用 var 声明变量时，变量会被自动添加到最接近的上下文。在函数中，最接近的上下文就是函数的局部上下文。在 with 语句中，最接近的上下文也是函数上下文。如果变量未经声明就被初始化了，那么它就会自动被添加到全局上下文。</p><p>var声明（不包含赋值）会被拿到函数或全局作用域的顶部，位于作用域中所有代码之前，这个现象叫作“提升”（hoisting）。
提升让同一作用域中的代码不必考虑变量是否已经声明就可以直接使用。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span> <span class=c1>// undefined，变量声明已提升，但赋值未提升
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/** 等价于 **/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>a</span><span class=p>);</span> <span class=c1>// undefined
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>a</span> <span class=o>=</span> <span class=mi>10</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>函数声明也会被提升到作用域顶部，且整个函数体都会被提升。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>sayHello</span><span class=p>();</span> <span class=c1>// &#34;Hello!&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>sayHello</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Hello!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/** 等价于 **/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>sayHello</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Hello!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>sayHello</span><span class=p>();</span> <span class=c1>// &#34;Hello!&#34;
</span></span></span></code></pre></td></tr></table></div></div><p>函数的提升优先级高于 var 变量提升。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>foo</span><span class=p>);</span> <span class=c1>// ƒ foo() { return &#34;function&#34;; }
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>foo</span> <span class=o>=</span> <span class=s2>&#34;variable&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=s2>&#34;function&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>foo</span><span class=p>);</span> <span class=c1>// &#34;variable&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=cm>/** 等价于 **/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>foo</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=s2>&#34;function&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>foo</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>foo</span><span class=p>);</span> <span class=c1>// ƒ foo() { return &#34;function&#34;; }
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>foo</span> <span class=o>=</span> <span class=s2>&#34;variable&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>foo</span><span class=p>);</span> <span class=c1>// &#34;variable&#34;
</span></span></span></code></pre></td></tr></table></div></div><h3 id=let-声明>let 声明</h3><p>ES6新增的let关键字跟var很相似，但它的作用域是块级的，这也是JavaScript中的新概念。块级作用域由最近的一对包含花括号{}界定。
换句话说，if块、while块、function块，甚至连单独的块也是let声明变量的作用域。</p><p>let 与 var 的另一个不同之处是在同一作用域内不能声明两次。重复的 var 声明会被忽略，而重复的 let 声明会抛出 SyntaxError。</p><p>严格来讲，let 在 JavaScript runtime 中也会被提升，但由于<b>暂时性死区（temporal dead zone）</b>的缘故，
实际上不能在声明之前使用 let 变量。因此，从写 JavaScript 代码的角度说，let 的提升跟 var 是不一样的。</p><h3 id=const-声明>const 声明</h3><p>使用 const 声明的变量必须在声明时初始化，并且在其生命周期内不能重新赋值。除了这一点外，const 的行为与 let 相同。</p><p>const 声明的限制仅适用于变量的顶层值或引用。换句话说，如果一个 const 变量引用的是对象，则不能将该变量重新赋予新的引用值，
但对象本身的属性可以修改。如果需要让整个对象不可更改，可以使用 <code>Object.freeze()</code> 方法，这样对对象属性的修改不会报错，但会静默失败。</p><p>由于 const 声明意味着变量的值是固定的且不可变，JavaScript 的运行时编译器可以将其优化为直接使用值，而无需通过变量查找。
所以在实际开发中，建议尽量使用 const 来声明变量。</p><h1 id=执行上下文与作用域>执行上下文与作用域</h1><h2 id=执行上下文>执行上下文</h2><p><mark>每当函数被调用、全局代码运行、或 eval 代码运行时，都会创建一个新的执行上下文，依此分为全局执行上下文、函数执行上下文、eval执行上下文。</mark></p><p>全局上下文是最外层的上下文。根据 ECMAScript 实现的宿主环境表示全局上下文的对象可能不一样（如浏览器中的 window 或 Node.js 中的 global），使用 var 声明的顶级变量会被添加到该对象上，使用 let 或 const 声明的顶级变量则被添加到脚本（Script）作用域，但三者在作用域的表现上是一样的。</p><p>函数调用时会创建函数上下文。函数执行时，函数的上下文会进入一个上下文栈，JavaScript 程序执行依靠的就是这个栈的控制。函数执行完后，其上下文会被弹出。</p><p>变量或函数的上下文决定了它们的生命周期、可以访问哪些数据以及它们的行为，即它们的执行环境。</p><p>每个上下文都关联一个<strong>变量对象（variable object, vo）</strong>，而这个上下文中定义的所有变量和函数都存在于这个对象上。如果上下文是函数，则其<b>活动对象（activation object）</b>用作变量对象。对于全局作用域，变量对象是全局对象（例如浏览器中的 window）。上下文包含以下三个重要部分：</p><ol><li>变量环境：是词法环境的一种特殊情况，专门用于存储通过 var 声明的变量。</li><li>词法环境：包含当前上下文的标识符（变量、函数）以及对父级上下文的引用。let 和 const 是存储在词法环境中的，它们支持块级作用域，并具有 <cite>TDZ<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></cite> 特性。</li><li>this 绑定：确定上下文中 this 的值，根据调用位置动态分配。</li></ol><p>执行上下文是动态的，所以它拥有生命周期：</p><ol><li>创建阶段<ul><li>变量对象初始化</li><li>作用域链创建</li><li>this 绑定</li></ul></li><li>执行阶段<ul><li>查找作用域链</li></ul></li><li>销毁阶段<ul><li>上下文在其所有代码都执行完毕后会被销毁，包括定义在它上面的所有变量和函数。</li></ul></li></ol><h2 id=作用域-scope>作用域 Scope</h2><p>作用域是变量和函数的可访问范围。它决定了代码中可以访问哪些变量。</p><p>作用域分为全局作用域、函数作用域和块作用域。</p><p>当前上下文的变量对象会与父级上下文的作用域链连接，形成一个作用域链。当访问一个变量时，JavaScript 引擎会沿着作用域链逐级向上查找，直到找到变量或到达全局作用域。上下文间是线性有序的，内部上下文可以通过作用域链访问外部上下文中的一切，但外部上下文无法访问内部上下文中的任何东西。</p><h2 id=函数的-scopes-属性>函数的 [[Scopes]] 属性</h2><p>函数的 [[Scopes]] 属性是 JavaScript 引擎内部用于实现作用域链的一个隐藏属性。它存储的是函数创建时的词法环境的引用，即是能够访问的所有外部作用域，是实现闭包的重要机制。这些作用域是按照作用域链的顺序排列的，最外层的作用域通常是全局作用域。</p><h3 id=查看-scopes-属性>查看 [[Scopes]] 属性</h3><p>1.使用 <code>debugger</code> 断点调试</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>outer</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>debugger</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>outerVar</span> <span class=o>=</span> <span class=s2>&#34;I am outer&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>inner</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>debugger</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>innerVar</span> <span class=o>=</span> <span class=s2>&#34;I am inner&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>outerVar</span><span class=p>);</span> <span class=c1>// 访问外部作用域的变量
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>inner</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>myInner</span> <span class=o>=</span> <span class=nx>outer</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>myInner</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>2.使用 <code>console.dir()</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>outer</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>outerVar</span> <span class=o>=</span> <span class=s2>&#34;I am outer&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>inner</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>innerVar</span> <span class=o>=</span> <span class=s2>&#34;I am inner&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>dir</span><span class=p>(</span><span class=nx>arguments</span><span class=p>.</span><span class=nx>callee</span><span class=p>);</span> <span class=c1>// 访问自身
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>outerVar</span><span class=p>);</span> <span class=c1>// 访问外部作用域的变量
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>dir</span><span class=p>(</span><span class=nx>arguments</span><span class=p>.</span><span class=nx>callee</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>inner</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>myInner</span> <span class=o>=</span> <span class=nx>outer</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>myInner</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>dir</span><span class=p>(</span><span class=nx>myInner</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=执行上下文与作用域的关系>执行上下文与作用域的关系</h2><ol><li>作用域在定义时确定（静态），执行上下文在运行时创建（动态）。</li><li>每个执行上下文都包含一个作用域链。</li></ol><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Temporal Dead Zone，暂时性死区，指变量只有声明后才能使用。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><footer class=article-footer><section class=article-tags><a href=/tags/javascript/>JavaScript</a></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/service-worker-api/><div class=article-details><h2 class=article-title>Service Worker API</h2></div></a></article><article><a href=/p/ecmascript-%E5%92%8C-javascript/><div class=article-details><h2 class=article-title>ECMAScript 和 JavaScript</h2></div></a></article><article><a href=/p/javascript-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/><div class=article-details><h2 class=article-title>JavaScript 内存管理</h2></div></a></article><article><a href=/p/javascript-%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD/><div class=article-details><h2 class=article-title>JavaScript 变量类型判断</h2></div></a></article><article><a href=/p/%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81/><div class=article-details><h2 class=article-title>防抖和节流</h2></div></a></article></div></div></aside><script src=//unpkg.com/@waline/client@v2/dist/waline.js></script><link href=//unpkg.com/@waline/client@v2/dist/waline.css rel=stylesheet><div id=waline class=waline-container></div><style>.waline-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding);--waline-font-size:var(--article-font-size)}.waline-container .wl-count{color:var(--card-text-color-main)}</style><script>Waline.init({avatar:"",dark:'html[data-scheme="dark"]',el:"#waline",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],lang:"",locale:{admin:"Admin",placeholder:null},placeholder:"",requiredMeta:["name","email","url"],serverURL:"my-waline-olive.vercel.app",visitor:""})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 DawnKylin</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.29.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>